<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?ifndef ProductVersion ?>
    <?define ProductVersion = "0.1.0" ?>
  <?endif?>
  <?ifndef UpgradeCode ?>
    <?define UpgradeCode = "B8A2AE7B-41E3-4E64-9A5F-41E1D1D6C6F8" ?>
  <?endif?>

  <Product Id="*"
           Name="AymaraLang"
           Language="1033"
           Version="$(var.ProductVersion)"
           Manufacturer="AymaraLang"
           UpgradeCode="$(var.UpgradeCode)">
    <Package InstallerVersion="500" Compressed="yes" InstallScope="perMachine" Platform="x64" />

    <MajorUpgrade DowngradeErrorMessage="Ya existe una versión más reciente de AymaraLang." />
    <MediaTemplate EmbedCab="yes" />

    <?ifdef ProductIcon?>
      <Icon Id="ProductIcon" SourceFile="$(var.ProductIcon)" />
      <Property Id="ARPPRODUCTICON" Value="ProductIcon" />
    <?endif?>

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />

    <Feature Id="CoreFeature" Title="Core" Level="1" Absent="disallow">
      <ComponentGroupRef Id="CoreBinFiles" />
      <ComponentGroupRef Id="CoreShareFiles" />
      <ComponentRef Id="DocsReadme" />
      <ComponentRef Id="DocsLicense" />
    </Feature>

    <Feature Id="LLVMFeature" Title="LLVM Backend" Level="2">
      <ComponentGroupRef Id="LLVMFiles" />
    </Feature>

    <Feature Id="PathFeature" Title="Add AymaraLang to PATH" Level="1">
      <ComponentRef Id="PathEnv" />
    </Feature>

    <UIRef Id="WixUI_FeatureTree" />
    <UIRef Id="WixUI_ErrorProgressText" />

    <?ifdef WixBanner?>
      <WixVariable Id="WixUIBannerBmp" Value="$(var.WixBanner)" />
    <?endif?>
    <?ifdef WixDialog?>
      <WixVariable Id="WixUIDialogBmp" Value="$(var.WixDialog)" />
    <?endif?>
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLDIR" Name="AymaraLang">
          <Directory Id="BINDIR" Name="bin" />
          <Directory Id="LLVMBACKENDDIR" Name="llvm-backend" />
          <Directory Id="SHAREDIR" Name="share" />
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <DirectoryRef Id="INSTALLDIR">
      <Component Id="DocsReadme" Guid="0E73F4ED-5A2F-4B8E-9A4E-6E4F4827C4CB">
        <File Id="ReadmeFile" Source="$(var.DistDir)\\README.md" KeyPath="yes" />
      </Component>
      <Component Id="DocsLicense" Guid="A2A60D5B-FDE2-4A8D-AE27-C4F07F6A4DC9">
        <File Id="LicenseFile" Source="$(var.DistDir)\\LICENSE" KeyPath="yes" />
      </Component>
      <Component Id="PathEnv" Guid="2B7B7A64-01E9-4C0C-9C82-CCF4A433E0E3">
        <Environment Id="PathEnvVar"
                     Name="PATH"
                     Value="[INSTALLDIR]bin"
                     Part="last"
                     System="yes"
                     Action="set" />
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
